jQuery(document).ready(function(t){"use strict";t("body"),t(".add-request-quote-button");var e=t(document).find(".widget_ywraq_list_quote, .widget_ywraq_mini_list_quote"),a="undefined"!=typeof ywraq_frontend&&ywraq_frontend.block_loader,r=(t(".yith-ywraq-item-remove"),t(".shipping_address")),i=t(".woocommerce-billing-fields");t.fn.yith_ywraq_variations=function(){var e=t('[name|="product_id"]'),a=e.val(),r=t(".add-to-quote-"+a).find("a.add-request-quote-button"),i=r.parents(".yith-ywraq-add-to-quote"),n=t('[name|="variation_id"]');if(!n.length)return!1;r.show().addClass("disabled"),n.on("change",function(){var a=[],n=""+i.attr("data-variation");"undefined"!=n&&(a=n.split(",")),t(".yith_ywraq_add_item_browse-list-"+e.val()).hide().removeClass("show"),t(".yith_ywraq_add_item_product-response-"+e.val()).hide().removeClass("show"),t(".yith_ywraq_add_item_response-"+e.val()).show().removeClass("hide"),""==t(this).val()?(r.show().addClass("disabled"),r.parent().show().removeClass("hide").removeClass("addedd"),t(".yith_ywraq_add_item_product-response-"+e.val()).hide().removeClass("show"),t(".yith_ywraq_add_item_response-"+e.val()).hide().removeClass("show"),t(".yith_ywraq_add_item_browse-list-"+e.val()).hide().removeClass("show")):t.inArray(t(this).val(),a)>=0?(r.hide(),t(".yith_ywraq_add_item_response-"+e.val()).show().removeClass("hide"),t(".yith_ywraq_add_item_browse-list-"+e.val()).show().removeClass("hide")):(r.show().removeClass("disabled"),t(".yith_ywraq_add_item_response-"+e.val()).hide().removeClass("show"),t(".yith_ywraq_add_item_browse-list-"+e.val()).hide().removeClass("show"))})},t.fn.yith_ywraq_variations(),t.fn.yith_ywraq_refresh_button=function(){var e=t('[name|="product_id"]').val();t(".add-to-quote-"+e).find("a.add-request-quote-button").parents(".yith-ywraq-add-to-quote");if(!t('[name|="variation_id"]').length)return!1},t.fn.yith_ywraq_refresh_button();var n=!1;t(document).on("click",".add-request-quote-button",function(r){r.preventDefault();var i=t(this),o=i.closest(".yith-ywraq-add-to-quote"),d="ac",s="";if(!i.hasClass("disabled")&&!n)if(void 0===(s=i.closest(".cart").length?i.closest(".cart"):o.siblings(".cart").first().length?o.siblings(".cart").first():t(t(".composite_form").length?".composite_form":".cart"))[0]||"function"!=typeof s[0].checkValidity||s[0].checkValidity()){if(i.closest("ul.products").length>0)var c="",_=(l=i.closest("li.product").find("a.add_to_cart_button")).data("product_id");else var c=i.closest(".product").find('input[name="add-to-cart"]'),l=i.closest(".product").find('input[name="product_id"]'),_=l.length?l.val():c.val();var u=void 0===_?i.data("product_id"):_;if((d=s.serializefiles()).append("context","frontend"),d.append("action","yith_ywraq_action"),d.append("ywraq_action","add_item"),d.append("product_id",i.data("product_id")),d.append("wp_nonce",i.data("wp_nonce")),d.append("yith-add-to-cart",i.data("product_id")),t(document).trigger("yith_ywraq_action_before"),"undefined"!=typeof yith_wapo_general&&!yith_wapo_general.do_submit)return!1;n=t.ajax({type:"POST",url:ywraq_frontend.ajaxurl.toString().replace("%%endpoint%%","yith_ywraq_action"),dataType:"json",data:d,contentType:!1,processData:!1,beforeSend:function(){i.after(' <img src="'+a+'" >')},complete:function(){i.next().remove()},success:function(a){"true"==a.result||"exists"==a.result?("yes"==ywraq_frontend.go_to_the_list?window.location.href=a.rqa_url:(t(".yith_ywraq_add_item_product-response-"+u).show().removeClass("hide").html(a.message),t(".yith_ywraq_add_item_browse-list-"+u).show().removeClass("hide"),i.parent().hide().removeClass("show").addClass("addedd"),t(".add-to-quote-"+u).attr("data-variation",a.variations),e.length&&(e.ywraq_refresh_widget(),e=t(document).find(".widget_ywraq_list_quote, .widget_ywraq_mini_list_quote"))),t(document).trigger("yith_wwraq_added_successfully")):"false"==a.result&&(t(".yith_ywraq_add_item_response-"+u).show().removeClass("hide").html(a.message),t(document).trigger("yith_wwraq_error_while_adding")),n=!1}})}else t('<input type="submit">').hide().appendTo(s).click().remove()}),t.fn.serializefiles=function(){var e=t(this),a=new FormData;t.each(t(e).find("input[type='file']"),function(e,r){t.each(t(r)[0].files,function(t,e){a.append(r.name,e)})}),console.log(t(e));var r=t(e).serializeArray();console.log(r);var i=!1;return t.each(r,function(t,e){("quantity"==e.name||e.name.indexOf("quantity"))&&(i=!0),"add-to-cart"!=e.name&&a.append(e.name,e.value)}),!1===i&&a.append("quantity",1),a},t.fn.ywraq_refresh_widget=function(){e.each(function(){var e=t(this),r=e.find(".yith-ywraq-list-wrapper"),i=e.find(".yith-ywraq-list"),n=e.find(".yith-ywraq-list-widget-wrapper").data("instance");t.ajax({type:"POST",url:ywraq_frontend.ajaxurl.toString().replace("%%endpoint%%","yith_ywraq_action"),data:n+"&ywraq_action=refresh_quote_list&action=yith_ywraq_action&context=frontend",beforeSend:function(){i.css("opacity",.5),e.hasClass("widget_ywraq_list_quote")&&r.prepend(' <img src="'+a+'" >')},complete:function(){e.hasClass("widget_ywraq_list_quote")&&r.next().remove(),i.css("opacity",1)},success:function(t){e.hasClass("widget_ywraq_mini_list_quote")?e.find(".yith-ywraq-list-widget-wrapper").html(t.mini):e.find(".yith-ywraq-list-widget-wrapper").html(t.large)}})})},t(document).on("click",".yith-ywraq-item-remove",function(a){a.preventDefault();var r=t(this),i=r.data("remove-item"),n=r.parents(".ywraq-wrapper"),o=(t("#yith-ywraq-form"),n.find(".wpcf7-form")),d="";d="context=frontend&action=yith_ywraq_action&ywraq_action=remove_item&key="+r.data("remove-item")+"&wp_nonce="+r.data("wp_nonce")+"&product_id="+r.data("product_id"),t.ajax({type:"POST",url:ywraq_frontend.ajaxurl.toString().replace("%%endpoint%%","yith_ywraq_action"),dataType:"json",data:d,beforeSend:function(){r.find(".ajax-loading").css("visibility","visible")},complete:function(){r.siblings(".ajax-loading").css("visibility","hidden")},success:function(a){if(1===a){var r=t("[data-remove-item='"+i+"']").parents(".cart_item");if(r.hasClass("composite-parent")){var n=r.data("composite-id");t("[data-composite-id='"+n+"']").remove()}if(r.hasClass("bundle-parent")){var d=r.data("bundle-key");t("[data-bundle-key='"+d+"']").remove()}r.remove(),0===t(".cart_item").length&&(o.length&&o.remove(),t("#yith-ywraq-form, .yith-ywraq-mail-form-wrapper").remove(),t("#yith-ywraq-message").html(ywraq_frontend.no_product_in_list)),e.length&&(e.ywraq_refresh_widget(),e=t(document).find(".widget_ywraq_list_quote, .widget_ywraq_mini_list_quote")),t(document).trigger("yith_wwraq_removed_successfully")}else t(document).trigger("yith_wwraq_error_while_removing")}})});t(".wpcf7-submit").closest(".wpcf7").length>0&&t(document).find(".wpcf7").each(function(){var e=t(this);e.find('input[name="_wpcf7"]').val()==ywraq_frontend.cform7_id&&e.on("wpcf7:mailsent",function(){t.ajax({type:"POST",url:ywraq_frontend.ajaxurl.toString().replace("%%endpoint%%","yith_ywraq_order_action"),dataType:"json",data:{lang:ywraq_frontend.current_lang,action:"yith_ywraq_order_action",current_user_id:ywraq_frontend.current_user_id,context:"frontend",ywraq_order_action:"mail_sent_order_created"},success:function(t){""!=t.rqa_url&&(window.location.href=t.rqa_url)}})})}),t("#yith-ywrq-table-list").on("change",".qty",function(){t(this).val()<=0&&t(this).val(1)});var o=t(".quotes-actions").find(".reject");t(".my_account_quotes");o.length&&(o.prettyPhoto({hook:"data-rel",social_tools:!1,theme:"pp_woocommerce",horizontal_padding:20,opacity:.8,deeplinking:!1}),o.on("click",function(e){e.preventDefault();var a=t(this).parents(".quotes-actions").data("order_id"),r=t("#modal-order-number");ywraq_frontend.current_lang;r.text(a),t(".reject-quote-modal-button").attr("data-order_id",a),o.prettyPhoto({hook:"data-rel",social_tools:!1,theme:"pp_woocommerce",horizontal_padding:20,opacity:.8,deeplinking:!1})})),t(document).on("click",".close-quote-modal-button",function(e){e.preventDefault(),t.prettyPhoto.close()}),t(document).on("click",".reject-quote-modal-button",function(e){e.preventDefault();var r=t(this),i=r.data("order_id"),n=(t("#modal-order-number"),r.closest("body").find(".my_account_quotes").find('[data-order_id="'+i+'"]').parent()),o="context=frontend&action=yith_ywraq_order_action&ywraq_order_action=reject_order&order_id="+i+"&lang="+ywraq_frontend.current_lang;t.ajax({type:"POST",url:ywraq_frontend.ajaxurl.toString().replace("%%endpoint%%","yith_ywraq_order_action"),dataType:"json",data:o,beforeSend:function(){n.after(' <img src="'+a+'" >')},complete:function(){n.next().remove()},success:function(e){0!==e.result&&(n.find(".reject").hide(),n.find(".accept").hide(),n.find(".raq_status").removeClass("pending").addClass("rejected").text(e.status),t.prettyPhoto.close())}})});var d;t(document).on("click, change",".product-quantity input",function(e){void 0!==d&&d.abort();var a=t(this),r=a.closest("table").find(".raq-totals"),i=a.closest("tr").find(".product-subtotal");if(void 0===(o=a.attr("name"))){var n=a.closest(".product-quantity").find(".input-text.qty"),o=n.attr("name"),s=n.val(),c=o.match(/[^[\]]+(?=])/g);a.hasClass("plus")&&s++,a.hasClass("minus")&&s--;_="context=frontend&action=yith_ywraq_action&ywraq_action=update_item_quantity&quantity="+s+"&key="+c[0]}else var _="context=frontend&action=yith_ywraq_action&ywraq_action=update_item_quantity&quantity="+(s=a.val())+"&key="+(c=o.match(/[^[\]]+(?=])/g))[0];d=t.ajax({type:"POST",url:ywraq_frontend.ajaxurl.toString().replace("%%endpoint%%","yith_ywraq_action"),dataType:"json",data:_,success:function(t){void 0!==t.total&&(i.html(t.line_total),r.length&&r.html(t.total))}})}),r.length>0&&1==ywraq_frontend.lock_shipping&&(r.find("input").attr("readonly","readonly"),r.find("select").attr("readonly","readonly")),i.length>0&&1==ywraq_frontend.lock_billing&&(i.find("input").attr("readonly","readonly"),i.find("select").attr("readonly","readonly")),t(document).bind("gform_confirmation_loaded",function(t,e){window.location.href=ywraq_frontend.rqa_url}),e.ywraq_refresh_widget()});